import random
import numpy as np
from sko.GA import GA
from sklearn import metrics

def target(p):
    # return abs(p[0]-0.5)+abs(p[1]-0.5)
    coef = [[0.050176, 0.000128, 4.967448, 0.150528], [0.075264, 0.000288, 3.989028, 0.150528], [0.075264, 0.000288, 3.989028, 0.150528], [0.075264, 0.000288, 3.989028, 0.150528], [0.018816, 0.000288, 2.765988, 0.06272], [0.03136, 0.0008, 2.66566, 0.06272], [0.03136, 0.0008, 2.66566, 0.06272], [0.03136, 0.0008, 2.66566, 0.06272], [0.00784, 0.0008, 1.9679, 0.03136], [0.01568, 0.0032, 2.58732, 0.03136], [0.01568, 0.0032, 2.58732, 0.03136], [0.01568, 0.0032, 2.58732, 0.03136], [0.01568, 0.0032, 2.58732, 0.03136], [0.01568, 0.0032, 2.8382, 0.037632], [0.018816, 0.004608, 3.706896, 0.037632], [0.018816, 0.004608, 3.706896, 0.037632], [0.018816, 0.004608, 3.706896, 0.037632], [0.004704, 0.004608, 2.761392, 0.018816], [0.009408, 0.018432, 3.66, 0.018816], [0.009408, 0.018432, 3.66, 0.018816], [0.009408, 0.018432, 3.66, 0.018816]]
    y = 0
    for i in range(21):
        a, b, c, d = coef[i][0], coef[i][1], coef[i][2], coef[i][3]
        k, e = p[2*i], p[2*i+1]
        y = y + a * np.square(k)*e+b*np.square(e)+c*e+d
    return abs(y-400)

def greedy():
    ga = GA(func=target, n_dim=42, size_pop=50, max_iter=800, lb=[5,4]*21, ub=[7,6]*21, precision=2,prob_mut=0.1)
    return ga.run()


if __name__ == '__main__':
    tmp = []
    for i in range(10):
        tmp.append(list(greedy()[0]))
    print(tmp)
